---
title: "Mesurer la Biodiversité"
author: "Eric Marcon"
date: "`r format(Sys.time(), '%d %B %Y')`"
url: https://EricMarcon.github.io/EcoComplex2025/
github-repo: EricMarcon/EcoComplex2025
bibliography: references.bib
biblio-style: chicago
urlcolor: blue
output:
  bookdown::beamer_presentation2:
    latex_engine: xelatex
    includes:
      in_header: latex/header.tex
    citation_package: natbib
    slide_level: 2
    df_print: kable
    number_sections: no
    toc: no
    fig_caption: no
    keep_tex: no
  bookdown::slidy_presentation2:
    slide_level: 2
  bookdown::ioslides_presentation2:
    logo: images/logo.png
    widescreen: true
  bookdown::powerpoint_presentation2:
    slide_level: 2
---

```{r}
#| label: DoNotModify
#| include: false
### Utilities. Do not modify.
# Installation of packages if necessary
install_packages <- function(packages) {
  install_package <- function(package) {
    if (!package %in% installed.packages()[, 1]) {
      install.packages(package, repos = "https://cran.rstudio.com/")
    }
  }
  invisible(sapply(packages, install_package))
}

# Basic packages
install_packages(c("bookdown", "formatR", "kableExtra", "ragg"))

# Chunk font size hook: allows size='small' or any valid Latex font size in chunk options
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(
    options$size != "normalsize", 
    paste0("\n \\", options$size,"\n\n", x, "\n\n \\normalsize"),
    x
  )
})
```

```{r}
#| label: Options
#| include: false
### Customized options for this document
# Add necessary packages here
packages <- c("tidyverse", "divent", "vegan")
# Install them
install_packages(packages)

# knitr options
knitr::opts_chunk$set(
  cache =   FALSE,    # Cache chunk results
  include = TRUE,     # Show/Hide chunks
  echo =    FALSE,    # Show/Hide code
  warning = FALSE,    # Show/Hide warnings
  message = FALSE,    # Show/Hide messages
  # Figure alignment and size
  fig.align = 'center', out.width = '80%',
  # Graphic devices (ragg_png is better than standard png)
  dev = c("ragg_png", "pdf"),
  # Code chunk format
  tidy = TRUE, tidy.opts = list(blank = FALSE, width.cutoff = 50),
  size = "scriptsize", knitr.graphics.auto_pdf = TRUE
)
options(width = 50)

# ggplot style
library("tidyverse")
theme_set(theme_bw())
theme_update(
  panel.background = element_rect(fill = "transparent", colour = NA),
  plot.background = element_rect(fill = "transparent", colour = NA)
)
knitr::opts_chunk$set(dev.args = list(bg = "transparent"))

# Tibbles: 5 lines, fit to slide width
options(tibble.print_min = 5, tibble.width = 50)

# Random seed
set.seed(973)
```

# Théorie

## Entropie

Expérience à plusieurs résultats possibles $\{r_1, r_2, \dots, r_s, \dots, r_S\}$

Probabilités associées $\{p_1, p_2, \dots, p_s, \dots, p_S\}$

Information $I(p_s)$, décroissante, $I(1) = 0$

Entropie = Information moyenne apportée par un individu: $\sum_s{p_s I(p_s)}$

## Exemples

@Shannon1948 : $I(p_s) = \ln{\frac{1}{p_s}}$ ; $H = \sum_s{p_s \ln{\frac{1}{p_s}}}$

@Renyi1961 : $^{\alpha}R = \frac{1}{1 - \alpha} \ln{\sum_s{p_s^\alpha}}$

@Tsallis1998a : $^{q}H = \frac{1}{q - 1} (1 - \sum_s{p_s^q})$.
Appelée HCDT [@Havrda1967; @Daroczy1970; @Tsallis1998a]

## Axiomatique

Les trois entropies respectent [@Patil1982; @Grabchak2016] :

-   Symétrie
-   Continuité par rapport aux probabilités
-   Principe des transferts, qui contient:
    -   L'ajout d'une espèce augmente la diversité
    -   Maximisation si toutes les probabilités sont égales

## Propriétés

$^{0}H$ est le nombre d'espèces -1 $^{1}H$ est l'entropie de Shannon $^{2}H$ est l'entropie de Simpson : $1 - \sum_s{p_s^2}$

$q$ paramétrise l'importance des espèces rares.

## Logarithmes déformés

@Tsallis1994:

$\ln_q{x} = \frac{x^{1-q} - 1}{1 - q}$

$e_q^x = \left[1 + \left(1 - q \right)x \right]^{\frac{1}{q - 1}}$

Simplifie l'écriture de l'entropie HCDT [@Marcon2014a] :

$^{q}H = \sum_s{p_s \ln_q{\frac{1}{p_s}}}$

## Résumé / Définitions 1

La rareté est l'inverse de la probabilité : $\frac{1}{p_s}$

L'information est le logarithme (déformé) de la rareté : $\ln_q{\frac{1}{p_s}}$

L'entropie est l'espérance de l'information :

$^{q}H = \sum_s{p_s \ln_q{\frac{1}{p_s}}}$

## Nombres de Hill

@Hill1973 : Nombre d'espèces équiprobables ayant l'entropie des données

Résume la diversité à un seul nombre : diversité au sens strict [@Jost2006]

La diversité est l'exponentielle de l'entropie [@Marcon2014a] :

$^{q}D = e_q^{^{q}H}$

# Pratique

## Barro Colorado Island

```{r}
library("vegan")
data(BCI)
```


## Courbe d'accumulatipn


## Diversité asymptotique



# Advanced code

## Slide with Incremental Bullets

Incremental bullets start with `> -` instead of `-`:

> -   Bullet 1
> -   A reference: @Xie2016.
> -   Bullet 3

## Slide with R Output

R code chunks are displayed as follows:

```{r}
#| label: cars
#| echo: true
head(cars)
```

## Slide with a Centered Plot {.flexbox .vcenter}

```{r}
#| label: pressure
plot(pressure)
```

## Two Column Layout {.columns-2}

\begincols
  \begincol{.48\textwidth}

This slide has two columns.

In Beamer, each column in between `\begincol` and `\endcol`.

In HTML, the `{.columns-2}` option is added to the slide title and `<p class="forceBreak"></p>` allows forcing column break.

\endcol \begincol{.48\textwidth}

<p class="forceBreak">

</p>

```{r}
#| label: pressure2
#| out-width: 90%
plot(pressure)
```

\endcol \endcols

## Documentation

See [R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/ioslides-presentation.html) for full documentation about HTML slides.

Note:

-   `{.flexbox .vcenter}` to center the HTML slide with plot.
-   `out.width='90%'` to reduce the size of the plot in the Two Column Layout slide.

Keep the code below to have a slide for references, allow two-column slides in *ioslides* (but not in *Slidy*) and allow scrolling oversized slides.

<!--# A slide for references -->

`r if (!knitr:::is_latex_output()) '## References {.smaller}'`

<!--# Styles for HTML slides -->

<!--# https://stackoverflow.com/questions/38260799/references-page-truncated-in-rmarkdown-ioslides-presentation/38294541#38294541 -->

```{=html}
<style>
  .forceBreak { -webkit-column-break-after: always; break-after: column; }
  slides > slide { overflow: scroll; }
  slides > slide:not(.nobackground):after { content: ''; }
</style>
```
